<crowd-form answer-format="flatten-objects">
  <section class="container-fluid" id="Relevancy">
    <div class="row">
      <div class="col-xs-12 col-md-12">
        <div class="panel panel-primary">
          <a class="panel-heading" href="javascript:void(0);" id="collapseTrigger">
            <strong>Annotation Instructions</strong>
            <span class="collapse-text">(Click to expand)</span>
          </a>
          <div class="panel-body" id="instructionBody">
            {{INSTRUCTIONS}}
            {{LINK}}
          </div>
        </div>
      </div>
    </div>

    Enable developer mode:
    <input type="checkbox" id="developer-mode">

    <h3>Document</h3>
    <div id="document-text" class="ann well well-sm">
      On 17 January 2019, a <role id='role-0-Vehicle-0'trigno='0'>vehicle</role> was <trigger id='trigger-0'>driven</trigger> into the General <role id='role-0-Destination-0'trigno='0'>Santander National Police Academy</role> in Bogotá, Colombia. The <role id='role-2-Instrument-0'trigno='2'><role id='role-1-Instrument-0'trigno='1'>truck</role></role> forced its way into the facility, <trigger id='trigger-1'>hit</trigger> a <role id='role-1-Target-0'trigno='1'>wall</role> and <trigger id='trigger-2'>detonated</trigger>, <trigger id='trigger-3'>killing</trigger> 22 <role id='role-3-Victim-0'trigno='3'>people</role> (including the perpetrator) and <trigger id='trigger-4'>injuring</trigger> 68 <role id='role-4-Victim-0'trigno='4'>others</role>. Suicide <trigger id='trigger-5'>attacks</trigger> are unusual in <role id='role-5-Place-0'trigno='5'>Colombia</role>. The car contained about of pentolite. It was the deadliest <trigger id='trigger-6'>attack</trigger> on the Colombian <role id='role-6-Target-0'trigno='6'>capital</role> since the 2003 <role id='role-7-Target-0'trigno='7'>El Nogal Club</role> <trigger id='trigger-7'>bombing</trigger> and the first <role id='role-8-Attacker-0'trigno='8'>terrorist</role> <trigger id='trigger-8'>attack</trigger> on the <role id='role-8-Target-0'trigno='8'>capital</role> since the 2017 <role id='role-9-Place-0'trigno='9'>Centro Andino</role> <trigger id='trigger-9'>bombing</trigger>. The National Liberation Army (<role id='role-10-Attacker-0'trigno='10'>ELN</role>) accepted responsibility for the <trigger id='trigger-10'>attack</trigger> and justified it as a response to the <trigger id='trigger-11'>bombings</trigger> made by the Colombian <role id='role-11-Attacker-0'trigno='11'>government</role> during the unilateral ceasefire. == Background == === Colombian conflict === The Colombian conflict started in 1964, although systematic violence in the country can be dated since the end of the 19th century (Thousand Days'War). The National Liberation Army (ELN) is one of the most prominent participants of the ongoing conflict. For decades, residents of Bogotá lived in fear of being a <role id='role-12-Target-0'trigno='12'>victim</role> of a <trigger id='trigger-12'>bombing</trigger> by leftist <role id='role-12-Attacker-0'trigno='12'>rebels</role> or Pablo Escobar's Medellín drug <role id='role-12-Attacker-1'trigno='12'>cartel</role>. But as Colombia's conflict has wound down, and the nation's largest rebel group, the Revolutionary Armed Forces of Colombia (FARC) disarmed under a 2016 peace deal, security has improved and <trigger id='trigger-13'>attacks</trigger> have become less frequent. Sporadic <trigger id='trigger-14'>attacks</trigger> have affected the <role id='role-14-Place-0'trigno='14'>city</role> since the peace deal was initiated. The most prominent was an <trigger id='trigger-15'>explosion</trigger> at the upmarket Andino shopping <role id='role-15-Target-0'trigno='15'>mall</role> in June 2017 which <trigger id='trigger-16'>killed</trigger> three <role id='role-16-Victim-0'trigno='16'>people</role>, including a French woman, and <trigger id='trigger-17'>injured</trigger> another <role id='role-17-Victim-0'trigno='17'>11</role>. Police later <trigger id='trigger-18'>arrested</trigger> several suspected <role id='role-18-Detainee-0'trigno='18'>members</role> of a far-left urban guerrilla group called the People Revolutionary's Movement for the <trigger id='trigger-19'>bombing</trigger>. === Peace dialogue === The 2016 peace deal between the FARC and Colombian government resulted in the ELN gaining strength in the region. The Colombian <role id='role-20-Participant-1'trigno='20'><role id='role-20-Participant-1'trigno='20'>government</role></role> has attempted to establish peace <trigger id='trigger-20'>dialogue</trigger> with the <role id='role-20-Participant-0'trigno='20'><role id='role-20-Participant-0'trigno='20'>ELN</role></role> since 2017, though ELN groups have rejected conditions placed by the government, such as the end of criminal actions including violent <trigger id='trigger-21'>attacks</trigger> and <trigger id='trigger-22'>kidnappings</trigger>. The ELN, however, persisted that the Colombian <role id='role-23-Participant-0'trigno='23'><role id='role-23-Participant-0'trigno='23'>government</role></role> should continue <trigger id='trigger-23'>dialogue</trigger> without making any demands towards the <role id='role-23-Participant-1'trigno='23'><role id='role-23-Participant-1'trigno='23'>group</role></role>. Between 2017 and up until the <trigger id='trigger-24'>attack</trigger>, Colombian officials stated that the ELN had participated in at least 400 <role id='role-25-Attacker-0'trigno='25'>terrorist</role> <trigger id='trigger-25'>attacks</trigger> in the <role id='role-25-Place-0'trigno='25'>nation</role> since dialogue began, including the <trigger id='trigger-26'>shoot</trigger> down of a civilian <role id='role-26-Target-0'trigno='26'>helicopter</role> and the <trigger id='trigger-27'>kidnapping</trigger> of its <role id='role-27-Victim-0'trigno='27'>occupants</role>. === ELN in Venezuela === According to InSight Crime, the <role id='role-28-Participant-1'trigno='28'><role id='role-28-Participant-1'trigno='28'>ELN</role></role> and FARC <role id='role-28-Participant-0'trigno='28'><role id='role-28-Participant-0'trigno='28'>dissidents</role></role> allegedly <trigger id='trigger-28'>met</trigger> together in <role id='role-28-Place-0'trigno='28'>Venezuela</role> to form a potential alliance in October 2018. Sources based in the Arauca department in Colombia provided the information, with reports that the groups would participate in illicit activity together. It was also alleged that former FARC commander <role id='role-29-Participant-1'trigno='29'><role id='role-29-Participant-1'trigno='29'>Iván Márquez</role></role> participated in the <trigger id='trigger-29'>talks</trigger> with the <role id='role-29-Participant-0'trigno='29'><role id='role-29-Participant-0'trigno='29'>ELN</role></role>. In November 2018, InSight Crime also reported that the ELN was present in over twelve Venezuelan states, spanning from the Colombia-Venezuela border in the west across Venezuela and into Brazil and Guyana to the east. Insight Crime states that Venezuelan president Nicolás Maduro was tolerant of the ELN, explaining that"ELN’s expansion in Venezuela has been marked by the Maduro administration’s inaction and even encouragement towards the group", with reports from Venezuelan NGO Fundación Redes that the Venezuelan military had possibly armed ELN members. == Events == === Planning === <role id='role-30-Identifier-0'trigno='30'>Attorney</role> General <trigger id='trigger-30'>identified</trigger> the <role id='role-30-IdentifiedObject-0'trigno='30'>perpetrator</role> as <role id='role-30-IdentifiedRole-0'trigno='30'>José Aldemar Rojas Rodríguez</role>, known as"Mocho Kiko"because of his missing hand due to a previous <trigger id='trigger-31'>explosion</trigger>, a 57-year-old from the northern department of Boyacá. Rojas is alleged to have been involved with the ELN for three decades and served as an intelligence chief for a branch of the group. Since 2011, Rojas is alleged to have been teaching guerrilla militants in Venezuela how to construct explosives. Ricardo Carvajal, <role id='role-35-Defendant-0'trigno='35'><role id='role-34-Defendant-0'trigno='34'><role id='role-32-Defendant-0'trigno='32'>who</role></role></role> was previously <trigger id='trigger-32'>investigated</trigger> for <trigger id='trigger-33'>drug trafficking</trigger> in 2012 but was <trigger id='trigger-34'>acquitted</trigger> of the <trigger id='trigger-35'>charges</trigger>, allegedly contracted Rojas for the <trigger id='trigger-36'>bombing</trigger> due to his experience. The <trigger id='trigger-37'>bombing</trigger>, according to Colombian authorities, had been planned for more than ten months. In May 2018, Colombian records show that <role id='role-38-Recipient-0'trigno='38'>Rojas</role> <trigger id='trigger-38'>purchased</trigger> a 1993 <role id='role-38-AcquiredEntity-0'trigno='38'>Nissan Patrol</role> from <role id='role-38-Giver-0'trigno='38'>Mauricio Mosquera</role>, <role id='role-39-Defendant-0'trigno='39'>who</role> was previously <trigger id='trigger-39'>charged</trigger> with terrorism and rebellion. On 27 July 2018, the <role id='role-40-ObservedEntity-0'trigno='40'>vehicle</role> was officially <trigger id='trigger-40'>inspected</trigger> in <role id='role-40-Place-0'trigno='40'>Arauca</role>, Arauca, a city found on the border of Colombia and Venezuela where the ELN mainly controls territory. === Attack === The authorities stated that on 17 January 2019 at 9: 30am, <role id='role-41-Transporter-0'trigno='41'>Rojas</role> <trigger id='trigger-41'>drove</trigger> his grey 1993 <role id='role-41-Vehicle-0'trigno='41'>Nissan Patrol</role> loaded with of <role id='role-41-PassengerArtifact-0'trigno='41'>pentolite</role> to the <role id='role-41-Destination-0'trigno='41'>campus</role> of the General Santander National Police Academy and dropped off a passenger at a nearby bus stop. <role id='role-42-Transporter-0'trigno='42'>Rojas</role> then reportedly <trigger id='trigger-42'>drove</trigger> his <role id='role-42-Vehicle-0'trigno='42'>truck</role> down a side <role id='role-42-Destination-0'trigno='42'>street</role> used for deliveries to make his way onto the campus. When a detection dog signaled explosives on the vehicle, the driver forced his vehicle through a security checkpoint and struck security guards. The <role id='role-43-ExplosiveDevice-0'trigno='43'>explosives</role> in the truck were then <trigger id='trigger-43'>detonated</trigger> near the women's <role id='role-43-Place-0'trigno='43'>dormitories</role> at the police academy as <role id='role-44-PassengerArtifact-0'trigno='44'>students</role> were <trigger id='trigger-44'>leaving</trigger> a promotion ceremony. It is unknown if the <role id='role-45-Attacker-0'trigno='45'>driver</role> <trigger id='trigger-45'>detonated</trigger> the <role id='role-45-ExplosiveDevice-0'trigno='45'>explosives</role> or if it was possibly the individual he left near the bus stop who remotely triggered the device. In the immediate aftermath, the <role id='role-46-Investigator-0'trigno='46'>authorities</role> began <trigger id='trigger-46'>investigating</trigger> <role id='role-46-Defendant-0'trigno='46'>Rojas</role>'s possible connections to either the National Liberation Army (ELN) guerrilla movement, the Clan Úsuga organized crime gang, or FARC dissidents. === Initial investigations === On 18 January, Defence <role id='role-47-Identifier-0'trigno='47'>Minister</role> <trigger id='trigger-47'>identified</trigger> <role id='role-47-IdentifiedObject-0'trigno='47'>Rojas Rodríguez</role> as a long-time <role id='role-47-IdentifiedRole-0'trigno='47'>member</role> of the ELN, within which he served as an explosives expert. <role id='role-48-Identifier-0'trigno='48'>Investigators</role> were able to <trigger id='trigger-48'>identify</trigger> <role id='role-48-IdentifiedObject-0'trigno='48'>Rojas</role> with security camera footage and fingerprints from his remaining hand. A second <role id='role-50-Detainee-0'trigno='50'>individual</role>, who Attorney General Martínez said"had participated in the <trigger id='trigger-49'>attack</trigger>", was <trigger id='trigger-50'>arrested</trigger> in <role id='role-50-Place-0'trigno='50'>Bogotá</role> at 2: 30am on the day following the <trigger id='trigger-51'>attack</trigger>. The <role id='role-52-IdentifiedObject-0'trigno='52'>individual</role> was <trigger id='trigger-52'>identified</trigger> as <role id='role-52-IdentifiedRole-0'trigno='52'>Ricardo Carvajal</role> after he allegedly confessed to the <trigger id='trigger-53'>bombings</trigger> over a telephone call <role id='role-54-Impeder-0'trigno='54'>investigators</role> <trigger id='trigger-54'>intercepted</trigger>. He was found with a"combatant's manual"and numerous coveralls. Carvajal Salgar denied that <role id='role-55-Attacker-0'trigno='55'>he</role> was involved in the <trigger id='trigger-55'>attack</trigger> and his family stated that the coveralls were used for the jobs he worked. According to Colombian authorities, there are on-going operations throughout Bogotá and the department of Arauca to <trigger id='trigger-56'>capture</trigger> other <role id='role-56-Detainee-0'trigno='56'>individuals</role> suspected of having been involved in the <trigger id='trigger-57'>attack</trigger>, and that the ELN was responsible despite the organization not taking claim for the <trigger id='trigger-58'>attack</trigger> as it has done in the past. === Peace dialogue ends === President Iván Duque Márquez announced on 18 January that peace <trigger id='trigger-59'>dialogue</trigger> between the <role id='role-59-Participant-0'trigno='59'><role id='role-59-Participant-0'trigno='59'>Government</role></role> of Colombia and the <role id='role-59-Participant-1'trigno='59'><role id='role-59-Participant-1'trigno='59'>ELN</role></role> was officially suspended. Duque also demanded that Cuba extradite the ten ELN leaders that found refuge on the island nation during peace talks and the reactivation of their Interpol Red Notices, and he criticized Venezuela for providing refuge for the ELN on the Colombia-Venezuela border. In response to the request, Cuba's Foreign Minister announced that Cuba would abide by the protocols of ongoing negotiations between both parties. The President of the National Constituent Assembly of Venezuela, Diosdado Cabello, denied any Venezuelan involvement in the <trigger id='trigger-60'>attacks</trigger> on 18 January. On 21 January, Colombian Foreign Minister Carlos Holmes Trujillo called for a"concrete response"from the government of Nicolás Maduro in Venezuela on whether the ELN was present in Venezuela, explaining that prior to the <trigger id='trigger-61'>attack</trigger>, the Colombian government asked the Venezuelan government on the potential presence of ELN groups in Venezuela without a response. Holmes Trujillo also stated that the Maduro government had taken"evasive positions"when speaking about the ELN. === Claim of responsibility === ELN accepted the responsibility for the <trigger id='trigger-62'>attack</trigger>, saying the <trigger id='trigger-63'>bombing</trigger> was carried out in retaliation for the Colombian government not honoring the ceasefire by carrying out <trigger id='trigger-64'>attacks</trigger> on its <role id='role-64-Place-0'trigno='64'>camps</role>. It justified that government and the cadres of its security forces had therefore become legitimate targets and called for resuming peace <trigger id='trigger-65'>dialogue</trigger>. High Peace Commissioner Miguel Ceballos spoke out against its members being sheltered anymore now that it had claimed responsibility. == International reactions == A foreign <role id='role-67-Victim-0'trigno='67'><role id='role-66-IdentifiedObject-0'trigno='66'>national</role></role>, <trigger id='trigger-66'>identified</trigger> as a female <role id='role-66-IdentifiedRole-0'trigno='66'>cadet</role> from Ecuador, was <trigger id='trigger-67'>killed</trigger> in the <trigger id='trigger-68'>attack</trigger>, while three <role id='role-69-Victim-0'trigno='69'>nationals</role> from Panama, <role id='role-69-Victim-2'trigno='69'>one</role> from the United States and <role id='role-69-Victim-1'trigno='69'>another</role> also from Ecuador were <trigger id='trigger-69'>wounded</trigger>. Their respective governments have expressed their condemnation for the <trigger id='trigger-70'>attack</trigger> and assistance to their citizens. * Cuba: Cuba shared condolences with Colombia, with its foreign ministry stating Cuba"will act with strict respect for the Protocols of <trigger id='trigger-71'>Dialogue</trigger> and Peace signed by the <role id='role-71-Participant-0'trigno='71'><role id='role-71-Participant-0'trigno='71'>Government</role></role> and the <role id='role-71-Participant-1'trigno='71'><role id='role-71-Participant-1'trigno='71'>ELN</role></role>, including the Protocol in Case of a Rupture in Negotiations". * Ecuador: President Lenín Moreno lamented the death of Erika Chicó, the Ecuadorian <role id='role-72-Victim-0'trigno='72'>cadet</role> <trigger id='trigger-72'>killed</trigger> in the <trigger id='trigger-73'>attack</trigger>, and expressed his condolences to Colombia. He also announced that <role id='role-74-Transporter-0'trigno='74'>he</role> was to <trigger id='trigger-74'>send</trigger> Vice <role id='role-74-PassengerArtifact-0'trigno='74'>President</role> Otto Sonnenholzner to <role id='role-74-Destination-0'trigno='74'>Bogotá</role> accompanied by Chicó's relatives. * Panama: The Panamanian embassy in Bogotá expressed its indignation at the <trigger id='trigger-75'>attack</trigger>, and provided a phone number for information about Panamanian cadets affected. * United States: The Assistant Secretary of State for Western Hemisphere Affairs Kimberly Breier condemned the <trigger id='trigger-76'>bombing</trigger> and said:"Our condolences and sympathies go to the victims and family members of <role id='role-77-Victim-0'trigno='77'>those</role> <trigger id='trigger-77'>killed</trigger>", while the U. S. Embassy in Bogotá offered <role id='role-78-Investigator-0'trigno='78'>its</role>"help in <trigger id='trigger-78'>investigating</trigger> this reprehensible <trigger id='trigger-79'>attack</trigger>". Argentina, Brazil, Peru, Venezuela, and the Organization of American States also condemned the <trigger id='trigger-80'>attack</trigger>. == References ==
    </div>

    <div id='events-data' hidden>
      [{"event_id": "wiki_mass_car_bombings_0_article-E1", "text": "driven", "offset": 8, "length": 1, "template": "[Transporter] transported [PassengerArtifact] in [Vehicle] from [Origin] place to [Destination] place", "role_text_map": [{"role": "Transporter", "tokens": []}, {"role": "PassengerArtifact", "tokens": []}, {"role": "Vehicle", "tokens": [{"text": "vehicle", "entity_id": "wiki_mass_car_bombings_0_article-T1", "offset": 6, "length": 1}]}, {"role": "Origin", "tokens": []}, {"role": "Destination", "tokens": [{"text": "Santander National Police Academy", "entity_id": "wiki_mass_car_bombings_0_article-T3", "offset": 12, "length": 4}]}]}, {"event_id": "wiki_mass_car_bombings_0_article-E2", "text": "hit", "offset": 30, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": [{"text": "wall", "entity_id": "wiki_mass_car_bombings_0_article-T9", "offset": 32, "length": 1}]}, {"role": "Instrument", "tokens": [{"text": "truck", "entity_id": "wiki_mass_car_bombings_0_article-T6", "offset": 22, "length": 1}]}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E3", "text": "detonated", "offset": 34, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": [{"text": "truck", "entity_id": "wiki_mass_car_bombings_0_article-T6", "offset": 22, "length": 1}]}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E4", "text": "killing", "offset": 36, "length": 1, "template": "[Victim] died at [Place] place from [MedicalIssue] medical issue, killed by [Killer] killer", "role_text_map": [{"role": "Victim", "tokens": [{"text": "people", "entity_id": "wiki_mass_car_bombings_0_article-T10", "offset": 38, "length": 1}]}, {"role": "Place", "tokens": []}, {"role": "Killer", "tokens": []}, {"role": "MedicalIssue", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E5", "text": "injuring", "offset": 45, "length": 1, "template": "[Victim] was injured by [Injurer] using [Instrument] in [BodyPart] body part with [MedicalCondition] medical issue at [Place] place", "role_text_map": [{"role": "Victim", "tokens": [{"text": "others", "entity_id": "wiki_mass_car_bombings_0_article-T12", "offset": 47, "length": 1}]}, {"role": "Injurer", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "BodyPart", "tokens": []}, {"role": "MedicalCondition", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E6", "text": "attacks", "offset": 50, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": [{"text": "Colombia", "entity_id": "wiki_mass_car_bombings_0_article-T13", "offset": 54, "length": 1}]}]}, {"event_id": "wiki_mass_car_bombings_0_article-E7", "text": "attack", "offset": 67, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": [{"text": "capital", "entity_id": "wiki_mass_car_bombings_0_article-T17", "offset": 71, "length": 1}]}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E8", "text": "bombing", "offset": 78, "length": 1, "template": "[Attacker] detonated or exploded [ExplosiveDevice] explosive device using [Instrument] to attack [Target] target at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": [{"text": "El Nogal Club", "entity_id": "wiki_mass_car_bombings_0_article-T18", "offset": 75, "length": 3}]}, {"role": "Instrument", "tokens": []}, {"role": "ExplosiveDevice", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E9", "text": "attack", "offset": 83, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": [{"text": "terrorist", "entity_id": "wiki_mass_car_bombings_0_article-T19", "offset": 82, "length": 1}]}, {"role": "Target", "tokens": [{"text": "capital", "entity_id": "wiki_mass_car_bombings_0_article-T20", "offset": 86, "length": 1}]}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E10", "text": "bombing", "offset": 92, "length": 1, "template": "[Attacker] detonated or exploded [ExplosiveDevice] explosive device using [Instrument] to attack [Target] target at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "ExplosiveDevice", "tokens": []}, {"role": "Place", "tokens": [{"text": "Centro Andino", "entity_id": "wiki_mass_car_bombings_0_article-T21", "offset": 90, "length": 2}]}]}, {"event_id": "wiki_mass_car_bombings_0_article-E11", "text": "attack", "offset": 105, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": [{"text": "ELN", "entity_id": "wiki_mass_car_bombings_0_article-T23", "offset": 99, "length": 1}]}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E12", "text": "bombings", "offset": 114, "length": 1, "template": "[Attacker] detonated or exploded [ExplosiveDevice] explosive device using [Instrument] to attack [Target] target at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": [{"text": "government", "entity_id": "wiki_mass_car_bombings_0_article-T25", "offset": 119, "length": 1}]}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "ExplosiveDevice", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E13", "text": "bombing", "offset": 196, "length": 1, "template": "[Attacker] detonated or exploded [ExplosiveDevice] explosive device using [Instrument] to attack [Target] target at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": [{"text": "rebels", "entity_id": "wiki_mass_car_bombings_0_article-T36", "offset": 199, "length": 1}, {"text": "cartel", "entity_id": "wiki_mass_car_bombings_0_article-T39", "offset": 207, "length": 1}]}, {"role": "Target", "tokens": [{"text": "victim", "entity_id": "wiki_mass_car_bombings_0_article-T35", "offset": 193, "length": 1}]}, {"role": "Instrument", "tokens": []}, {"role": "ExplosiveDevice", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E14", "text": "attacks", "offset": 248, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E15", "text": "attacks", "offset": 255, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": [{"text": "city", "entity_id": "wiki_mass_car_bombings_0_article-T45", "offset": 259, "length": 1}]}]}, {"event_id": "wiki_mass_car_bombings_0_article-E16", "text": "explosion", "offset": 272, "length": 1, "template": "[Attacker] detonated or exploded [ExplosiveDevice] explosive device using [Instrument] to attack [Target] target at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": [{"text": "mall", "entity_id": "wiki_mass_car_bombings_0_article-T47", "offset": 278, "length": 1}]}, {"role": "Instrument", "tokens": []}, {"role": "ExplosiveDevice", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E17", "text": "killed", "offset": 283, "length": 1, "template": "[Victim] died at [Place] place from [MedicalIssue] medical issue, killed by [Killer] killer", "role_text_map": [{"role": "Victim", "tokens": [{"text": "people", "entity_id": "wiki_mass_car_bombings_0_article-T48", "offset": 285, "length": 1}]}, {"role": "Place", "tokens": []}, {"role": "Killer", "tokens": []}, {"role": "MedicalIssue", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E18", "text": "injured", "offset": 293, "length": 1, "template": "[Victim] was injured by [Injurer] using [Instrument] in [BodyPart] body part with [MedicalCondition] medical issue at [Place] place", "role_text_map": [{"role": "Victim", "tokens": [{"text": "11", "entity_id": "wiki_mass_car_bombings_0_article-T51", "offset": 295, "length": 1}]}, {"role": "Injurer", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "BodyPart", "tokens": []}, {"role": "MedicalCondition", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E19", "text": "arrested", "offset": 299, "length": 1, "template": "[Jailer] arrested or jailed [Detainee] for [Crime] crime at [Place] place", "role_text_map": [{"role": "Jailer", "tokens": []}, {"role": "Detainee", "tokens": [{"text": "members", "entity_id": "wiki_mass_car_bombings_0_article-T53", "offset": 302, "length": 1}]}, {"role": "Crime", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E20", "text": "bombing", "offset": 320, "length": 1, "template": "[Attacker] detonated or exploded [ExplosiveDevice] explosive device using [Instrument] to attack [Target] target at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "ExplosiveDevice", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E23", "text": "dialogue", "offset": 354, "length": 1, "template": "[Participant] communicated with [Participant] about [Topic] topic at [Place] place (document does not specify in person or not, or one-way or not)", "role_text_map": [{"role": "Participant", "tokens": [{"text": "ELN", "entity_id": "wiki_mass_car_bombings_0_article-T63", "offset": 357, "length": 1}, {"text": "government", "entity_id": "wiki_mass_car_bombings_0_article-T62", "offset": 348, "length": 1}]}, {"role": "Participant", "tokens": [{"text": "ELN", "entity_id": "wiki_mass_car_bombings_0_article-T63", "offset": 357, "length": 1}, {"text": "government", "entity_id": "wiki_mass_car_bombings_0_article-T62", "offset": 348, "length": 1}]}, {"role": "Topic", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E21", "text": "attacks", "offset": 381, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E22", "text": "kidnappings", "offset": 383, "length": 1, "template": "[Perpetrator] committed a crime against [Victim] at [Place] place", "role_text_map": [{"role": "Perpetrator", "tokens": []}, {"role": "Victim", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E24", "text": "dialogue", "offset": 397, "length": 1, "template": "[Participant] communicated with [Participant] about [Topic] topic at [Place] place (document does not specify in person or not, or one-way or not)", "role_text_map": [{"role": "Participant", "tokens": [{"text": "government", "entity_id": "wiki_mass_car_bombings_0_article-T69", "offset": 394, "length": 1}, {"text": "group", "entity_id": "wiki_mass_car_bombings_0_article-T70", "offset": 404, "length": 1}]}, {"role": "Participant", "tokens": [{"text": "government", "entity_id": "wiki_mass_car_bombings_0_article-T69", "offset": 394, "length": 1}, {"text": "group", "entity_id": "wiki_mass_car_bombings_0_article-T70", "offset": 404, "length": 1}]}, {"role": "Topic", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E25", "text": "attack", "offset": 412, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E26", "text": "attacks", "offset": 427, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": [{"text": "terrorist", "entity_id": "wiki_mass_car_bombings_0_article-T74", "offset": 426, "length": 1}]}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": [{"text": "nation", "entity_id": "wiki_mass_car_bombings_0_article-T75", "offset": 430, "length": 1}]}]}, {"event_id": "wiki_mass_car_bombings_0_article-E27", "text": "shoot", "offset": 437, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": [{"text": "helicopter", "entity_id": "wiki_mass_car_bombings_0_article-T77", "offset": 442, "length": 1}]}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E28", "text": "kidnapping", "offset": 445, "length": 1, "template": "[Perpetrator] committed a crime against [Victim] at [Place] place", "role_text_map": [{"role": "Perpetrator", "tokens": []}, {"role": "Victim", "tokens": [{"text": "occupants", "entity_id": "wiki_mass_car_bombings_0_article-T79", "offset": 448, "length": 1}]}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E29", "text": "met", "offset": 466, "length": 1, "template": "[Participant] communicated with [Participant] about [Topic] topic at [Place] place (document does not specify in person or not, or one-way or not)", "role_text_map": [{"role": "Participant", "tokens": [{"text": "dissidents", "entity_id": "wiki_mass_car_bombings_0_article-T85", "offset": 464, "length": 1}, {"text": "ELN", "entity_id": "wiki_mass_car_bombings_0_article-T83", "offset": 461, "length": 1}]}, {"role": "Participant", "tokens": [{"text": "dissidents", "entity_id": "wiki_mass_car_bombings_0_article-T85", "offset": 464, "length": 1}, {"text": "ELN", "entity_id": "wiki_mass_car_bombings_0_article-T83", "offset": 461, "length": 1}]}, {"role": "Topic", "tokens": []}, {"role": "Place", "tokens": [{"text": "Venezuela", "entity_id": "wiki_mass_car_bombings_0_article-T86", "offset": 469, "length": 1}]}]}, {"event_id": "wiki_mass_car_bombings_0_article-E30", "text": "talks", "offset": 516, "length": 1, "template": "[Participant] communicated with [Participant] about [Topic] topic at [Place] place (document does not specify in person or not, or one-way or not)", "role_text_map": [{"role": "Participant", "tokens": [{"text": "ELN", "entity_id": "wiki_mass_car_bombings_0_article-T95", "offset": 519, "length": 1}, {"text": "Iv\u00e1n M\u00e1rquez", "entity_id": "wiki_mass_car_bombings_0_article-T94", "offset": 511, "length": 2}]}, {"role": "Participant", "tokens": [{"text": "ELN", "entity_id": "wiki_mass_car_bombings_0_article-T95", "offset": 519, "length": 1}, {"text": "Iv\u00e1n M\u00e1rquez", "entity_id": "wiki_mass_car_bombings_0_article-T94", "offset": 511, "length": 2}]}, {"role": "Topic", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E31", "text": "identified", "offset": 627, "length": 1, "template": "[Identifier] identified [IdentifiedObject] as [IdentifiedRole] at [Place] place", "role_text_map": [{"role": "Identifier", "tokens": [{"text": "Attorney", "entity_id": "wiki_mass_car_bombings_0_article-T125", "offset": 625, "length": 1}]}, {"role": "IdentifiedObject", "tokens": [{"text": "perpetrator", "entity_id": "wiki_mass_car_bombings_0_article-T126", "offset": 629, "length": 1}]}, {"role": "IdentifiedRole", "tokens": [{"text": "Jos\u00e9 Aldemar Rojas Rodr\u00edguez", "entity_id": "wiki_mass_car_bombings_0_article-T127", "offset": 631, "length": 4}]}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E32", "text": "explosion", "offset": 651, "length": 1, "template": "[Attacker] detonated or exploded [ExplosiveDevice] explosive device using [Instrument] to attack [Target] target at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "ExplosiveDevice", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E33", "text": "investigated", "offset": 717, "length": 1, "template": "[Investigator] investigated [Defendant] for [Crime] crime in [Place] place", "role_text_map": [{"role": "Investigator", "tokens": []}, {"role": "Defendant", "tokens": [{"text": "who", "entity_id": "wiki_mass_car_bombings_0_article-T143", "offset": 714, "length": 1}]}, {"role": "Crime", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E34", "text": "drug trafficking", "offset": 719, "length": 2, "template": "[Giver] bought, sold, or traded [AcquiredEntity] to [Recipient] in exchange for [PaymentBarter] for the benefit of [Beneficiary] at [Place] place", "role_text_map": [{"role": "Giver", "tokens": []}, {"role": "Recipient", "tokens": []}, {"role": "AcquiredEntity", "tokens": []}, {"role": "PaymentBarter", "tokens": []}, {"role": "Beneficiary", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E37", "text": "acquitted", "offset": 725, "length": 1, "template": "[JudgeCourt] court or judge acquitted [Defendant] of [Crime] crime in [Place] place", "role_text_map": [{"role": "JudgeCourt", "tokens": []}, {"role": "Defendant", "tokens": [{"text": "who", "entity_id": "wiki_mass_car_bombings_0_article-T143", "offset": 714, "length": 1}]}, {"role": "Crime", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E36", "text": "charges", "offset": 728, "length": 1, "template": "[Prosecutor] charged or indicted [Defendant] before [JudgeCourt] court or judge for [Crime] crime in [Place] place", "role_text_map": [{"role": "Prosecutor", "tokens": []}, {"role": "Defendant", "tokens": [{"text": "who", "entity_id": "wiki_mass_car_bombings_0_article-T143", "offset": 714, "length": 1}]}, {"role": "JudgeCourt", "tokens": []}, {"role": "Crime", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E35", "text": "bombing", "offset": 735, "length": 1, "template": "[Attacker] detonated or exploded [ExplosiveDevice] explosive device using [Instrument] to attack [Target] target at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "ExplosiveDevice", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E38", "text": "bombing", "offset": 742, "length": 1, "template": "[Attacker] detonated or exploded [ExplosiveDevice] explosive device using [Instrument] to attack [Target] target at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "ExplosiveDevice", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E39", "text": "purchased", "offset": 767, "length": 1, "template": "[Giver] bought, sold, or traded [AcquiredEntity] to [Recipient] in exchange for [PaymentBarter] for the benefit of [Beneficiary] at [Place] place", "role_text_map": [{"role": "Giver", "tokens": [{"text": "Mauricio Mosquera", "entity_id": "wiki_mass_car_bombings_0_article-T151", "offset": 773, "length": 2}]}, {"role": "Recipient", "tokens": [{"text": "Rojas", "entity_id": "wiki_mass_car_bombings_0_article-T149", "offset": 766, "length": 1}]}, {"role": "AcquiredEntity", "tokens": [{"text": "Nissan Patrol", "entity_id": "wiki_mass_car_bombings_0_article-T150", "offset": 770, "length": 2}]}, {"role": "PaymentBarter", "tokens": []}, {"role": "Beneficiary", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E40", "text": "charged", "offset": 779, "length": 1, "template": "[Prosecutor] charged or indicted [Defendant] before [JudgeCourt] court or judge for [Crime] crime in [Place] place", "role_text_map": [{"role": "Prosecutor", "tokens": []}, {"role": "Defendant", "tokens": [{"text": "who", "entity_id": "wiki_mass_car_bombings_0_article-T152", "offset": 776, "length": 1}]}, {"role": "JudgeCourt", "tokens": []}, {"role": "Crime", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E41", "text": "inspected", "offset": 794, "length": 1, "template": "[Observer] observed [ObservedEntity] using [Instrument] in [Place] place", "role_text_map": [{"role": "Observer", "tokens": []}, {"role": "ObservedEntity", "tokens": [{"text": "vehicle", "entity_id": "wiki_mass_car_bombings_0_article-T153", "offset": 791, "length": 1}]}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": [{"text": "Arauca", "entity_id": "wiki_mass_car_bombings_0_article-T154", "offset": 796, "length": 1}]}]}, {"event_id": "wiki_mass_car_bombings_0_article-E42", "text": "drove", "offset": 834, "length": 1, "template": "[Transporter] transported [PassengerArtifact] in [Vehicle] from [Origin] place to [Destination] place", "role_text_map": [{"role": "Transporter", "tokens": [{"text": "Rojas", "entity_id": "wiki_mass_car_bombings_0_article-T164", "offset": 833, "length": 1}]}, {"role": "PassengerArtifact", "tokens": [{"text": "pentolite", "entity_id": "wiki_mass_car_bombings_0_article-T167", "offset": 843, "length": 1}]}, {"role": "Vehicle", "tokens": [{"text": "Nissan Patrol", "entity_id": "wiki_mass_car_bombings_0_article-T166", "offset": 838, "length": 2}]}, {"role": "Origin", "tokens": []}, {"role": "Destination", "tokens": [{"text": "campus", "entity_id": "wiki_mass_car_bombings_0_article-T168", "offset": 846, "length": 1}]}]}, {"event_id": "wiki_mass_car_bombings_0_article-E43", "text": "drove", "offset": 868, "length": 1, "template": "[Transporter] transported [PassengerArtifact] in [Vehicle] from [Origin] place to [Destination] place", "role_text_map": [{"role": "Transporter", "tokens": [{"text": "Rojas", "entity_id": "wiki_mass_car_bombings_0_article-T173", "offset": 865, "length": 1}]}, {"role": "PassengerArtifact", "tokens": []}, {"role": "Vehicle", "tokens": [{"text": "truck", "entity_id": "wiki_mass_car_bombings_0_article-T175", "offset": 870, "length": 1}]}, {"role": "Origin", "tokens": []}, {"role": "Destination", "tokens": [{"text": "street", "entity_id": "wiki_mass_car_bombings_0_article-T176", "offset": 874, "length": 1}]}]}, {"event_id": "wiki_mass_car_bombings_0_article-E44", "text": "detonated", "offset": 917, "length": 1, "template": "[Attacker] detonated or exploded [ExplosiveDevice] explosive device using [Instrument] to attack [Target] target at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "ExplosiveDevice", "tokens": [{"text": "explosives", "entity_id": "wiki_mass_car_bombings_0_article-T186", "offset": 911, "length": 1}]}, {"role": "Place", "tokens": [{"text": "dormitories", "entity_id": "wiki_mass_car_bombings_0_article-T189", "offset": 923, "length": 1}]}]}, {"event_id": "wiki_mass_car_bombings_0_article-E45", "text": "leaving", "offset": 931, "length": 1, "template": "[Transporter] transported [PassengerArtifact] in [Vehicle] from [Origin] place to [Destination] place", "role_text_map": [{"role": "Transporter", "tokens": []}, {"role": "PassengerArtifact", "tokens": [{"text": "students", "entity_id": "wiki_mass_car_bombings_0_article-T192", "offset": 929, "length": 1}]}, {"role": "Vehicle", "tokens": []}, {"role": "Origin", "tokens": []}, {"role": "Destination", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E46", "text": "detonated", "offset": 942, "length": 1, "template": "[Attacker] detonated or exploded [ExplosiveDevice] explosive device using [Instrument] to attack [Target] target at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": [{"text": "driver", "entity_id": "wiki_mass_car_bombings_0_article-T193", "offset": 941, "length": 1}]}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "ExplosiveDevice", "tokens": [{"text": "explosives", "entity_id": "wiki_mass_car_bombings_0_article-T194", "offset": 944, "length": 1}]}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E47", "text": "investigating", "offset": 972, "length": 1, "template": "[Investigator] investigated [Defendant] for [Crime] crime in [Place] place", "role_text_map": [{"role": "Investigator", "tokens": [{"text": "authorities", "entity_id": "wiki_mass_car_bombings_0_article-T201", "offset": 970, "length": 1}]}, {"role": "Defendant", "tokens": [{"text": "Rojas", "entity_id": "wiki_mass_car_bombings_0_article-T202", "offset": 973, "length": 1}]}, {"role": "Crime", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E48", "text": "identified", "offset": 1011, "length": 1, "template": "[Identifier] identified [IdentifiedObject] as [IdentifiedRole] at [Place] place", "role_text_map": [{"role": "Identifier", "tokens": [{"text": "Minister", "entity_id": "wiki_mass_car_bombings_0_article-T211", "offset": 1010, "length": 1}]}, {"role": "IdentifiedObject", "tokens": [{"text": "Rojas Rodr\u00edguez", "entity_id": "wiki_mass_car_bombings_0_article-T212", "offset": 1012, "length": 2}]}, {"role": "IdentifiedRole", "tokens": [{"text": "member", "entity_id": "wiki_mass_car_bombings_0_article-T213", "offset": 1019, "length": 1}]}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E49", "text": "identify", "offset": 1037, "length": 1, "template": "[Identifier] identified [IdentifiedObject] as [IdentifiedRole] at [Place] place", "role_text_map": [{"role": "Identifier", "tokens": [{"text": "Investigators", "entity_id": "wiki_mass_car_bombings_0_article-T219", "offset": 1033, "length": 1}]}, {"role": "IdentifiedObject", "tokens": [{"text": "Rojas", "entity_id": "wiki_mass_car_bombings_0_article-T220", "offset": 1038, "length": 1}]}, {"role": "IdentifiedRole", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E50", "text": "attack", "offset": 1064, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E51", "text": "arrested", "offset": 1068, "length": 1, "template": "[Jailer] arrested or jailed [Detainee] for [Crime] crime at [Place] place", "role_text_map": [{"role": "Jailer", "tokens": []}, {"role": "Detainee", "tokens": [{"text": "individual", "entity_id": "wiki_mass_car_bombings_0_article-T222", "offset": 1052, "length": 1}]}, {"role": "Crime", "tokens": []}, {"role": "Place", "tokens": [{"text": "Bogot\u00e1", "entity_id": "wiki_mass_car_bombings_0_article-T225", "offset": 1070, "length": 1}]}]}, {"event_id": "wiki_mass_car_bombings_0_article-E52", "text": "attack", "offset": 1080, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E53", "text": "identified", "offset": 1085, "length": 1, "template": "[Identifier] identified [IdentifiedObject] as [IdentifiedRole] at [Place] place", "role_text_map": [{"role": "Identifier", "tokens": []}, {"role": "IdentifiedObject", "tokens": [{"text": "individual", "entity_id": "wiki_mass_car_bombings_0_article-T226", "offset": 1083, "length": 1}]}, {"role": "IdentifiedRole", "tokens": [{"text": "Ricardo Carvajal", "entity_id": "wiki_mass_car_bombings_0_article-T227", "offset": 1087, "length": 2}]}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E54", "text": "bombings", "offset": 1095, "length": 1, "template": "[Attacker] detonated or exploded [ExplosiveDevice] explosive device using [Instrument] to attack [Target] target at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "ExplosiveDevice", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E55", "text": "intercepted", "offset": 1101, "length": 1, "template": "[Impeder] impeded or interfered with [ImpededEvent] event at [Place] place", "role_text_map": [{"role": "Impeder", "tokens": [{"text": "investigators", "entity_id": "wiki_mass_car_bombings_0_article-T229", "offset": 1100, "length": 1}]}, {"role": "ImpededEvent", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E56", "text": "attack", "offset": 1127, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": [{"text": "he", "entity_id": "wiki_mass_car_bombings_0_article-T233", "offset": 1122, "length": 1}]}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E58", "text": "capture", "offset": 1162, "length": 1, "template": "[Jailer] arrested or jailed [Detainee] for [Crime] crime at [Place] place", "role_text_map": [{"role": "Jailer", "tokens": []}, {"role": "Detainee", "tokens": [{"text": "individuals", "entity_id": "wiki_mass_car_bombings_0_article-T242", "offset": 1164, "length": 1}]}, {"role": "Crime", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E57", "text": "attack", "offset": 1172, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E59", "text": "attack", "offset": 1188, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E60", "text": "dialogue", "offset": 1212, "length": 1, "template": "[Participant] communicated with [Participant] about [Topic] topic at [Place] place (document does not specify in person or not, or one-way or not)", "role_text_map": [{"role": "Participant", "tokens": [{"text": "Government", "entity_id": "wiki_mass_car_bombings_0_article-T248", "offset": 1215, "length": 1}, {"text": "ELN", "entity_id": "wiki_mass_car_bombings_0_article-T250", "offset": 1220, "length": 1}]}, {"role": "Participant", "tokens": [{"text": "Government", "entity_id": "wiki_mass_car_bombings_0_article-T248", "offset": 1215, "length": 1}, {"text": "ELN", "entity_id": "wiki_mass_car_bombings_0_article-T250", "offset": 1220, "length": 1}]}, {"role": "Topic", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E62", "text": "attacks", "offset": 1316, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E63", "text": "attack", "offset": 1360, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E64", "text": "attack", "offset": 1413, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E65", "text": "bombing", "offset": 1417, "length": 1, "template": "[Attacker] detonated or exploded [ExplosiveDevice] explosive device using [Instrument] to attack [Target] target at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "ExplosiveDevice", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E66", "text": "attacks", "offset": 1434, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": [{"text": "camps", "entity_id": "wiki_mass_car_bombings_0_article-T296", "offset": 1437, "length": 1}]}]}, {"event_id": "wiki_mass_car_bombings_0_article-E67", "text": "dialogue", "offset": 1460, "length": 1, "template": "[Participant] communicated with [Participant] about [Topic] topic at [Place] place (document does not specify in person or not, or one-way or not)", "role_text_map": [{"role": "Participant", "tokens": []}, {"role": "Participant", "tokens": []}, {"role": "Topic", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E68", "text": "identified", "offset": 1490, "length": 1, "template": "[Identifier] identified [IdentifiedObject] as [IdentifiedRole] at [Place] place", "role_text_map": [{"role": "Identifier", "tokens": []}, {"role": "IdentifiedObject", "tokens": [{"text": "national", "entity_id": "wiki_mass_car_bombings_0_article-T308", "offset": 1488, "length": 1}]}, {"role": "IdentifiedRole", "tokens": [{"text": "cadet", "entity_id": "wiki_mass_car_bombings_0_article-T309", "offset": 1494, "length": 1}]}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E69", "text": "killed", "offset": 1499, "length": 1, "template": "[Victim] died at [Place] place from [MedicalIssue] medical issue, killed by [Killer] killer", "role_text_map": [{"role": "Victim", "tokens": [{"text": "national", "entity_id": "wiki_mass_car_bombings_0_article-T308", "offset": 1488, "length": 1}]}, {"role": "Place", "tokens": []}, {"role": "Killer", "tokens": []}, {"role": "MedicalIssue", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E70", "text": "attack", "offset": 1502, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E71", "text": "wounded", "offset": 1521, "length": 1, "template": "[Victim] was injured by [Injurer] using [Instrument] in [BodyPart] body part with [MedicalCondition] medical issue at [Place] place", "role_text_map": [{"role": "Victim", "tokens": [{"text": "nationals", "entity_id": "wiki_mass_car_bombings_0_article-T311", "offset": 1506, "length": 1}, {"text": "another", "entity_id": "wiki_mass_car_bombings_0_article-T315", "offset": 1516, "length": 1}, {"text": "one", "entity_id": "wiki_mass_car_bombings_0_article-T313", "offset": 1510, "length": 1}]}, {"role": "Injurer", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "BodyPart", "tokens": []}, {"role": "MedicalCondition", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E72", "text": "attack", "offset": 1532, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E73", "text": "Dialogue", "offset": 1564, "length": 1, "template": "[Participant] communicated with [Participant] about [Topic] topic at [Place] place (document does not specify in person or not, or one-way or not)", "role_text_map": [{"role": "Participant", "tokens": [{"text": "Government", "entity_id": "wiki_mass_car_bombings_0_article-T328", "offset": 1570, "length": 1}, {"text": "ELN", "entity_id": "wiki_mass_car_bombings_0_article-T329", "offset": 1573, "length": 1}]}, {"role": "Participant", "tokens": [{"text": "Government", "entity_id": "wiki_mass_car_bombings_0_article-T328", "offset": 1570, "length": 1}, {"text": "ELN", "entity_id": "wiki_mass_car_bombings_0_article-T329", "offset": 1573, "length": 1}]}, {"role": "Topic", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E74", "text": "killed", "offset": 1603, "length": 1, "template": "[Victim] died at [Place] place from [MedicalIssue] medical issue, killed by [Killer] killer", "role_text_map": [{"role": "Victim", "tokens": [{"text": "cadet", "entity_id": "wiki_mass_car_bombings_0_article-T335", "offset": 1602, "length": 1}]}, {"role": "Place", "tokens": []}, {"role": "Killer", "tokens": []}, {"role": "MedicalIssue", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E75", "text": "attack", "offset": 1606, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E76", "text": "send", "offset": 1622, "length": 1, "template": "[Transporter] transported [PassengerArtifact] in [Vehicle] from [Origin] place to [Destination] place", "role_text_map": [{"role": "Transporter", "tokens": [{"text": "he", "entity_id": "wiki_mass_car_bombings_0_article-T339", "offset": 1619, "length": 1}]}, {"role": "PassengerArtifact", "tokens": [{"text": "President", "entity_id": "wiki_mass_car_bombings_0_article-T340", "offset": 1624, "length": 1}]}, {"role": "Vehicle", "tokens": []}, {"role": "Origin", "tokens": []}, {"role": "Destination", "tokens": [{"text": "Bogot\u00e1", "entity_id": "wiki_mass_car_bombings_0_article-T342", "offset": 1628, "length": 1}]}]}, {"event_id": "wiki_mass_car_bombings_0_article-E77", "text": "attack", "offset": 1649, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E78", "text": "bombing", "offset": 1680, "length": 1, "template": "[Attacker] detonated or exploded [ExplosiveDevice] explosive device using [Instrument] to attack [Target] target at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "ExplosiveDevice", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E79", "text": "killed", "offset": 1698, "length": 1, "template": "[Victim] died at [Place] place from [MedicalIssue] medical issue, killed by [Killer] killer", "role_text_map": [{"role": "Victim", "tokens": [{"text": "those", "entity_id": "wiki_mass_car_bombings_0_article-T360", "offset": 1697, "length": 1}]}, {"role": "Place", "tokens": []}, {"role": "Killer", "tokens": []}, {"role": "MedicalIssue", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E80", "text": "investigating", "offset": 1715, "length": 1, "template": "[Investigator] investigated [Defendant] for [Crime] crime in [Place] place", "role_text_map": [{"role": "Investigator", "tokens": [{"text": "its", "entity_id": "wiki_mass_car_bombings_0_article-T363", "offset": 1711, "length": 1}]}, {"role": "Defendant", "tokens": []}, {"role": "Crime", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E81", "text": "attack", "offset": 1718, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": []}]}, {"event_id": "wiki_mass_car_bombings_0_article-E82", "text": "attack", "offset": 1738, "length": 1, "template": "[Attacker] attacked [Target] using [Instrument] at [Place] place", "role_text_map": [{"role": "Attacker", "tokens": []}, {"role": "Target", "tokens": []}, {"role": "Instrument", "tokens": []}, {"role": "Place", "tokens": []}]}]
    </div>

    <div id='relations-data' hidden>
      []
    </div>

    <div id="strategyB-tuples" hidden>
      ${strategyB-tuples}
    </div>

    <p>
      You can navigate all of the events by clicking the following buttons. <br>
      You have to finish all the events before submitting. (Remember that you can't refresh the page otherwise
      the progress will be gone, <br>
      to prevent this from happening, we suggest that you write the QA pairs in the google doc and copy paste them
      here)
    </p>
    <!-- Tabs for each trigger -->
    <div class="btn-toolbar" id="button-bar">
    </div>

    <div class="strategies">
      <span id="strategy-btns">
        <button id="selectA" class="btn btn-default" type="button">
          Strategy A</button>
        <button id="selectB" class="btn btn-default" type="button">
          Strategy B</button>
      </span>
      <select id="tuple-select">
      </select>
      <div class="ann-component">
        <em>
          KAIROS event arguments for triggers
        </em>
        <div id='template-area' class='ann well well-sm'>
        </div>
      </div>
      <div class="strategy" id="strategyA">
        <div class="ann-component">
          <em>
            These are relations between events.
          </em>
          <div id='relations-area' class='ann well well-sm'>
          </div>
        </div>
      </div>
      <div class="strategy" id="strategyB">
      </div>
    </div>
    <div id="input-area">
    </div>
    <div title="Fill all fields before submitting">
      <button id="save" class="btn btn-default" type="button">Save</button>
      <button id="submitButton" class="btn btn-default" type="button">Submit</button>
    </div>
  </section>


  <link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" rel="stylesheet" />
  <style>.mg-15 {
    margin-left: 15px;
    margin-right: 15px;
}

.mg-5 {
    margin: 5px;
}

.container-fluid {
    max-width: 1800px;
    margin: 30px;
}

.btn-container {
    display: inline-block;
    margin: 10px;
}

.strategies {
    margin: 15px;
}

.ann-component {
    margin: 5px;
}


#collapseTrigger {
    color: #fff;
    display: block;
    text-decoration: none;
}

#submitButton {
    white-space: normal;
}

#input-area {
    display: block;
    margin: 10px;
}

.input-fields {
    margin: 10px;
    padding: 10px;
    background-color: #ffe3e3;
    border-radius: 15px;
}

#template-area {
    background-color: #eee;
    display: flex;
}

#relations-area {
    display: flex;
    flex-direction: column;
    row-gap: 5px;
}

.template-map {
    border: 1px solid gray;
    padding: 5px;
}

.btn-container>button {
    min-width: 3em;
}

trigger {
    display: inline;
}

role {
    display: inline;
}

.highlight-trigger {
    background-color: lightgoldenrodyellow;
}

.highlight-role {
    background-color: lightblue;
}

.highlight-role1 {
    background-color: rgba(255, 255, 0, 0.5);
}

.highlight-role2 {
    background-color: rgba(0, 255, 255, 0.5);
}

.highlight-role3 {
    background-color: rgba(255, 0, 255, 0.5);
}

.btn-group {
    vertical-align: middle;
}

.content {
    margin-bottom: 15px;
}

.ann {
    font-size: 16px;
}

.disp {
    font-size: 20px;
}

.ann>span.token {
    cursor: pointer;
}

.ann>span.token:hover {
    text-decoration: underline;
}

.ann>strong.annotation:hover {
    text-decoration: line-through;
}

input[disabled] {
    color: #000
}

.question-input, .answer-input {
    vertical-align: middle;
}</style>
  <script src="https://code.jquery.com/jquery-3.1.0.min.js"
    integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s=" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/2.4.1/lodash.min.js"></script>
  <script>// ---------------------------------------------------------
// Global
// ---------------------------------------------------------

var page_num_set = new Set();
let strategy = '';
let developer_mode = false;

// ---------------------------------------------------------
// Create jQuery elements
// ---------------------------------------------------------

var submit = $('#submitButton');

// list of text/offset objects 
const events_data = JSON.parse($('#events-data').text().trim());
const relations_data = JSON.parse($('#relations-data').text().trim());
const strategyB_tuples = [["road_ied_8-E1", "road_ied_8-E2", "road_ied_8-E3"]];//JSON.parse($('#strategyB-tuples').text().trim());

const empty_template_map = function () {
    return $('<div class="template-map">');
}

const save_record = {
    A: {
        relations: relations_data,
        qapairs: [],
    },
    B: {
        qapairs: [],
    },
};

const strategyA_template = function (tno, event1, event2) {
    return {
        question: '',
        answer: '',
    }
}

const template_record = [];
events_data.forEach(function (ei, i) {
    template_record[i] = empty_template_map();
    events_data.forEach(function (ej, j) {
        if (i >= j) return;

        for (let tno = 1; tno <= 4; tno++){
            {
                const { question, answer } = strategyA_template(tno, ei, ej);
                save_record.A.qapairs.push({
                    event1_id: ei.event_id,
                    event2_id: ej.event_id,
                    templateno: tno,
                    question,
                    answer,
                });
            }
            {
                const { question, answer } = strategyA_template(tno, ej, ei);
                save_record.A.qapairs.push({
                    event1_id: ej.event_id,
                    event2_id: ei.event_id,
                    templateno: tno,
                    question,
                    answer,
                });
            }
        }
    });
});

function strategyB_template(event1_id, event2_id, event3_id) {
    const question = 'What is the participant in the event that interviews the transporter that flew the place that gone off the explosive device. ';
    const answer = '';
    return {
        question, answer
    };
}

strategyB_tuples.forEach(function (tuple, i) {
    const { question, answer } = strategyB_template(tuple[0], tuple[1], tuple[2]);
    save_record.B.qapairs.push({
        event1_id: tuple[0],
        event2_id: tuple[1],
        event3_id: tuple[2],
        question,
        answer,
    });
});

// implementation of string formatting
if (!String.prototype.format) {
    String.prototype.format = function () {
        var args = arguments;
        return this.replace(/{(\d+)}/g, function (match, number) {
            return typeof args[number] != 'undefined'
                ? args[number]
                : match
                ;
        });
    };
}

// ---------------------------------------------------------
// Create elements
// ---------------------------------------------------------

var makeDom = function () {
    recoverUserInput();
    console.log(page_num_set);
    highlightEvent();
};

var highlightEvent = function () {
    /* highlight trigger within document */
    const pagenos = Array.from(page_num_set);
    pagenos.sort((a, b) => events_data[a].offset - events_data[b].offset);

    // remove previous highlights
    $('trigger').removeClass('highlight-trigger');
    $('role').removeClass('highlight-role1 highlight-role2 highlight-role3');

    pagenos.forEach(trigger_num => {
        // highlight trigger
        $('#trigger-' + trigger_num).addClass('highlight-trigger');
        $('role[trigno=' + trigger_num + ']').addClass('highlight-role'+(trigger_num+1));
    })
}

const relationTypes = [
    "BEFORE",
    "AFTER",
    "OVERLAPS",
    "EQUAL",
    "CONTAINS",
    "CONTAINED BY",
    "CAUSES",
    "CAUSED BY",
]

// restore input from other trigger
var recoverUserInput = function () {
    const inputArea = $('#input-area');
    inputArea.empty();
    page_num_set.clear();

    let pagenos = [];
    if (strategy === 'A') {
        // questions
        const event_pair = $('#tuple-select').val().split(',').map(x => parseInt(x));
        page_num_set.add(event_pair[0]);
        page_num_set.add(event_pair[1]);

        pagenos = event_pair;
        pagenos.sort((a, b) => events_data[a].offset - events_data[b].offset);

        // relations
        const relationsArea = $('#relations-area');
        relationsArea.empty();
        pagenos.forEach(i => {
            pagenos.forEach(j => {
                if (i >= j) return;

                const event1 = events_data[i];
                const event2 = events_data[j];
                relationsArea.append(makeRelationSelect(event1, event2));
                relationsArea.append(makeRelationSelect(event2, event1));
            })
        })

        const matching_pairs = save_record.A.qapairs.filter(qa => {
            return (
                (qa.event1_id === events_data[event_pair[0]].event_id &&
                qa.event2_id === events_data[event_pair[1]].event_id) ||
                (qa.event1_id === events_data[event_pair[1]].event_id &&
                qa.event2_id === events_data[event_pair[0]].event_id)
            );
        });
        matching_pairs.forEach((qa, i) => {
            add_qa_input(qa.question, qa.answer, qa);
            if (i % 2 === 1 && i < matching_pairs.length - 1)
                inputArea.add($('<hr>'));
        });
    } else if (strategy === 'B') {
        const tuple = save_record.B.qapairs[$('#tuple-select').val()];
        console.log("TUPLE", tuple)
        page_num_set.add(events_data.findIndex(e => e.event_id === tuple.event1_id));
        page_num_set.add(events_data.findIndex(e => e.event_id === tuple.event2_id));
        page_num_set.add(events_data.findIndex(e => e.event_id === tuple.event3_id));
        pagenos = Array.from(page_num_set);
        pagenos.sort((a, b) => events_data[a].offset - events_data[b].offset);
        add_qa_input(tuple.question, tuple.answer, null, false);
        add_qa_input('', '', tuple, true);
    }
    // templates
    const templateArea = $('#template-area');
    templateArea.empty()
    pagenos.forEach(trigger_num => {
        const div = $('<div>')
            .append($('<p>').text(describeEvent(events_data[trigger_num])))
            .append(template_record[trigger_num]);
        templateArea.append(div);
    });
};

function describeEvent(event) {
    return (developer_mode ? `ID: ${event.event_id} | ` : "") + `${event.text} @ ${event.offset}`;
}

function makeRelationSelect(event1, event2) {
    const id1 = event1.event_id;
    const id2 = event2.event_id;
    const relation = relations_data.find(r =>
        r.event1_id == id1 &&
        r.event2_id == id2
    );

    const selectInput =
        $('<select class="relation-select mg-5">');
    relationTypes.forEach(type => {
        const option = $(`<option value="${type}">${type.toLowerCase()}</option>`);
        selectInput.append(option);
    });
    selectInput.append($('<option value="NONE">none</option>'));
    selectInput.val(relation?.type ?? "NONE");
    selectInput.on('change', function () {
        const type = $(this).val();
        const event1_id = id1;
        const event2_id = id2;
        const relation = relations_data.find(r =>
            r.event1_id == event1_id &&
            r.event2_id == event2_id
        );
        if (relation) {
            relation.type = type;
        } else {
            relations_data.push({
                event1_id,
                event2_id,
                type,
            });
        }
    });

    const div = $('<div>')
        .append($('<label>').text(describeEvent(event1)))
        .append(selectInput)
        .append($('<label>').text(describeEvent(event2)))

    return div;
}

// ensure something is in the input box
var canSubmit = function () {
    return true;
};

// template role fields
const make_role_mapping_element = function (role, text) {
    const role_text = $('<label>').html('<b>' + role + '</b>:');
    const role_field = $('<span>')
        .addClass('role-field')
        .attr({
            role: role,
            rows: 1,
        })
        .text(text)

    const role_div = $('<div>')
        .addClass('role-container')
        .append(role_text)
        .append(role_field);

    return role_div;
}


const add_qa_input = function (question = '', answer = '', ref = null, editable = true) {
    let question_text = $('<label>').text('question:');
    let question_input = $('<textarea>')
        .addClass('question-input')
        .addClass('mg-15')
        .attr({
            placeholder: 'write down your question',
            rows: 2,
            cols: 80,
        })
        .text(question);
    question_input.on("input", function () {
        console.log('q', ref)
        if (ref != null)
            ref.question = $(this).val();
        show();
    });
    let answer_text = $('<label>').text('answer:');
    let answer_input = $('<textarea>')
        .addClass('answer-input')
        .addClass('mg-15')
        .attr({
            placeholder: 'write down your answer',
            rows: 2,
            cols: 80,
        })
        .text(answer);
    answer_input.on("input", function () {
        console.log('a', ref)
        if (ref != null)
            ref.answer = $(this).val();
        show();
    });

    if (!editable) {
        question_input.attr('disabled', 'disabled');
        answer_input.attr('disabled', 'disabled');
    }

    const input_fields = $('<div>')
        .addClass('input-fields')
        .append(question_text)
        .append(question_input)
        .append(answer_text)
        .append(answer_input)

    $('#input-area').append(input_fields);

    show();
};

var enable_button = function (button) {
    button.removeAttr("disabled");
    button.removeClass("btn-default");
    button.addClass("btn-success");
};

var disable_button = function (button) {
    button.attr("disabled", "disabled");
    button.removeClass("btn-success");
    button.addClass("btn-default");
};

var select_button = function (button) {
    button.removeClass("btn-default");
    button.addClass("btn-primary");
};

var deselect_button = function (button) {
    button.removeClass("btn-primary");
    button.addClass("btn-default");
};

var is_wh_question = function (question) {
    let tokens = question.split(' ');
    if (tokens.length <= 1) {
        return false;
    }

    // let wh_pattern = /^Wh\|wh\|How\|how/;
    let wh_pattern = /^wh|Wh|how|How/;
    // console.log(question.match(wh_pattern));
    return !!question.match(wh_pattern);
};


var show = function () {
    for (button of document.getElementById('button-bar').getElementsByTagName('*')) {
        if (page_num_set.has(parseInt(button.getAttribute('page-no'))))
            select_button($(button));
        else
            deselect_button($(button));
    }

};

// dynamically create buttons for each SRL arg
events_data.forEach(function (event, i) {
    if (event.text.trim()) {
        var button = document.createElement("button");
        button.setAttribute("type", "button");
        button.setAttribute("id", "button-page-" + i);
        button.setAttribute("page-no", i);
        button.setAttribute("class", "btn btn-default");
        button.innerHTML = describeEvent(event);
        button.onclick = function () {
            // const pageno = parseInt(this.getAttribute("page-no"));
            // // toggle button
            // if (button.classList.contains('btn-default'))
            //     page_num_set.add(pageno);
            // else
            //     page_num_set.delete(pageno);
            // makeDom();
            // let instruction = $('#instructionBody');
            // if (instruction.is(':visible')) {
            //     instruction.toggle();
            // }
            // //window.scrollTo(0, 0); // scroll to top
            // show();
        }
        document.getElementById('button-bar').appendChild(button);
    }

    // format template area with role mappings
    // if template not null or undefined
    if (event.template !== null) {
        const template_area = template_record[i];
        const template = $('<p>').text(event.template);
        template_area.append(template);
        event.role_text_map.forEach(function (pairing) {
            template_area.append(make_role_mapping_element(pairing.role, pairing.tokens.map(tk => tk.text).join('/')));
        });
    }
})

// ---------------------------------------------------------
// Initialize
// ---------------------------------------------------------

var submit_form = function (event) {
    event.preventDefault();
    if (!window.confirm("Are you sure you want to submit?")) return;
    save_all();

    const urlParams = new URLSearchParams(window.location.search)

    // create the form element and point it to the correct endpoint
    const form = document.createElement('form')
    form.action = (new URL('mturk/externalSubmit', urlParams.get('turkSubmitTo'))).href
    form.method = 'post'

    // attach the assignmentId
    const inputAssignmentId = document.createElement('input')
    inputAssignmentId.name = 'assignmentId'
    inputAssignmentId.value = urlParams.get('assignmentId')
    inputAssignmentId.hidden = true
    form.appendChild(inputAssignmentId)

    // attach data I want to send back
    const inputResults = document.createElement('input')
    inputResults.name = 'results'
    inputResults.value = JSON.stringify(save_record)
    inputResults.hidden = true
    form.appendChild(inputResults)

    // attach the form to the HTML document and trigger submission
    document.body.appendChild(form)
    form.submit()
}

//$('#save').on('click', save_all);
submit.on('click', submit_form);

var popup_alert = function (alert_box, text) {
    alert_box.html(text);
    alert_box.css({
        'background-color': 'fec5bb',
        'padding': '5px',
        'border': '1px solid lightgray',
        'border-radius': '10px',
        'margin-top': '10px',
        'margin-bottom': '10px'
    });
    displaying = true;
    setTimeout(function () {
        alert_box.html('');
        alert_box.css({
            'padding': '0px',
            'border': '0px'
        });
        displaying = false;
    }, 7000);
};

const selectA = $('#selectA');
const selectB = $('#selectB');

const tupleSelect = $('#tuple-select');


function makeSelectionOptions() {
    if (strategy === 'A') {
        tupleSelect.empty();
        events_data.forEach(function (ei, i) {
            events_data.forEach(function (ej, j) {
                if (i >= j) return;
                const opt = $('<option>')
                    .attr({
                        value: `${i},${j}`,
                    })
                    .text(`${describeEvent(ei)} & ${describeEvent(ej)}`);
                tupleSelect.append(opt);
            });
        });
        tupleSelect.children()[0].selected = true;
    } else {
        tupleSelect.empty();
        function describeEventById(id) {
            const event = events_data.find(e => e.event_id === id);
            return describeEvent(event);
        }
        strategyB_tuples.forEach(function (tuple, i) {
            const opt = $('<option>')
                .attr({
                    value: i,
                })
                .text(`${describeEventById(tuple[0])}, ${describeEventById(tuple[1])}, ${describeEventById(tuple[2])}`);
            tupleSelect.append(opt);
        });
        tupleSelect.children()[0].selected = true;
    }
}

selectA.on('click', function () {
    if (strategy === 'A') return;
    strategy = 'A';
    $('#strategyA').show();
    select_button(selectA);
    $('#strategyB').hide();
    deselect_button(selectB);
    makeSelectionOptions();
    makeDom();
    show();
});

selectB.on('click', function () {
    if (strategy === 'B') return;
    strategy = 'B';
    $('#strategyA').hide();
    deselect_button(selectA);
    $('#strategyB').show();
    select_button(selectB);
    makeSelectionOptions();
    makeDom();
    show();
});

selectA.click();

tupleSelect.on('change', function () {
    makeDom();
    show();
});

$('#developer-mode').on('change', function () {
    developer_mode = this.checked;
    makeSelectionOptions();
    makeDom();
    show();
});

// Instructions expand/collapse
var content = $('#instructionBody');
var instructions_trigger = $('#collapseTrigger');
// content.hide();
$('.collapse-text').text('(Click to collapse)');
instructions_trigger.click(function () {
    content.toggle();
    var isVisible = content.is(':visible');
    if (isVisible) {
        $('.collapse-text').text('(Click to collapse)');
    } else {
        $('.collapse-text').text('(Click to expand)');
    }
});

console.log(save_record)
show();
</script>
</crowd-form>